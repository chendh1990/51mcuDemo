C51 COMPILER V9.00   SYSCLK                                                                11/07/2015 14:53:13 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE SYSCLK
OBJECT MODULE PLACED IN ..\out\obj\SysClk.obj
COMPILER INVOKED BY: C:\Program Files\Keil\C51\BIN\C51.EXE ..\source\SysClk.c LARGE BROWSE INCDIR(..\OS;..\include) DEBU
                    -G OBJECTEXTEND PRINT(..\out\list\SysClk.lst) OBJECT(..\out\obj\SysClk.obj)

line level    source

   1          #include "sys.h"
   2          #include "uart.h"
   3          #include "RF_remote.h"
   4          #include "SysClk.h"
   5          
   6          xdata Real_Time_t g_RTC;
   7          /////////////////SYSTEM TICK SETTING//////////////////////////
   8          void SysClkInit(void)
   9          {
  10   1              TMOD=0X11;
  11   1              TR1 = 1;
  12   1              ET1 = 1;
  13   1      ////////initial rtc//////////
  14   1              g_RTC.Year = RTC_DEFAULT_YEAR;
  15   1              g_RTC.Month = RTC_DEFAULT_MONTH;
  16   1              g_RTC.Day = RTC_DEFAULT_DAY;
  17   1              g_RTC.Hour= RTC_DEFAULT_HOUR;
  18   1              g_RTC.Minute = RTC_DEFAULT_MINUTE;
  19   1              g_RTC.Second = RTC_DEFAULT_DAY;
  20   1              g_RTC.TickCount = 0;
  21   1      }
  22          
  23          void RtcTick(void)
  24          {
  25   1              if(++g_RTC.TickCount == OS_TICKS_PER_SEC)
  26   1              {
  27   2                      g_RTC.TickCount = 0;
  28   2                      if(++g_RTC.Second == 60)
  29   2                      {
  30   3                              g_RTC.Second = 0;
  31   3                              HostMsgPost(SYS_MSG_MINUTE_UPDATE, NULL);
  32   3                              if(++g_RTC.Minute == 60)
  33   3                              {
  34   4                                      g_RTC.Minute = 0;
  35   4                                      if(++g_RTC.Hour == 24)
  36   4                                      {
  37   5                                              g_RTC.Hour = 0;
  38   5                                              if(++g_RTC.Month == 13)
  39   5                                              {
  40   6                                                      g_RTC.Month = 1;
  41   6                                                      if(++g_RTC.Year == 100)
  42   6                                                      {
  43   7                                                              g_RTC.Year = 0;
  44   7                                                      }
  45   6                                              }
  46   5                                      }
  47   4                              }
  48   3                      }
  49   2              }
  50   1      }
  51          
  52          void UserTickTimer(void)
  53          {
  54   1              TL1 = 58;
C51 COMPILER V9.00   SYSCLK                                                                11/07/2015 14:53:13 PAGE 2   

  55   1              TH1 = 0X9E;
  56   1      ////UPDATE RTC///////////////
  57   1              RtcTick();
  58   1      //////UART TXD&RXD CHECK/////
  59   1              UartTickCheck(UART_PC);
  60   1              UartTickCheck(UART_WIFI);
  61   1      ////////////////////////////////
  62   1              RFTickHandle();
  63   1      }
  64          
  65          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    127    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      7    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
